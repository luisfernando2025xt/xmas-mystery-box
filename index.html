<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>XMAS Mystery Box â€” Premium</title>
<style>
  :root{
    --gold: #ffd86b;
    --soft-white: #f7f7f7;
  }
  html,body{height:100%;margin:0;background:#000;color:var(--soft-white);font-family: "Courier New", monospace;}
  .stage{height:100%;display:flex;align-items:center;justify-content:center;padding:30px;box-sizing:border-box;overflow:hidden;}
  .card{width:760px;max-width:95vw;padding:28px;border-radius:12px;text-align:center;position:relative;z-index:5}
  h1{margin:0 0 12px 0;font-size:28px;letter-spacing:1px}
  .controls{margin-top:10px}
  button{background:transparent;border:2px solid var(--soft-white);color:var(--soft-white);padding:12px 22px;font-size:16px;cursor:pointer;border-radius:8px;transition:.25s;backdrop-filter: blur(2px)}
  button:hover{background:var(--soft-white);color:#000}
  #ascii-box{margin-top:22px;white-space:pre;font-size:13px;line-height:15px;display:none;opacity:0;transition:opacity .8s ease-in-out, transform .6s ease-in-out;padding:18px;border-radius:8px}
  #typing{margin-top:18px;font-size:16px;min-height:48px;display:none;opacity:0;transition:opacity .6s ease-in-out}
  /* gold glow */
  .glow{box-shadow:0 6px 30px rgba(255,216,107,0.08), inset 0 0 40px rgba(255,210,100,0.03); border:1px solid rgba(255,215,100,0.08)}
  .gold-highlight{animation:goldPulse 1.6s ease-in-out;}
  @keyframes goldPulse{
    0%{text-shadow:0 0 0 rgba(255,215,100,0)}
    50%{text-shadow:0 0 24px rgba(255,205,80,0.55)}
    100%{text-shadow:0 0 0 rgba(255,215,100,0)}
  }
  /* secret flash effect */
  .cinemaOverlay{position:fixed;inset:0;background:radial-gradient(ellipse at center, rgba(0,0,0,0.0) 0%, rgba(0,0,0,0.85) 45%);pointer-events:none;opacity:0;transition:opacity .6s}
  .cinemaOn{opacity:1}
  /* improved snow via varying classes */
  .snowflake{position:fixed;top:-4vh;color:var(--soft-white);pointer-events:none;opacity:.85;font-size:12px;z-index:6}
  /* signature */
  .sig{margin-top:14px;font-size:12px;color:rgba(255,255,255,0.6)}
  /* small controls area */
  .small{margin-left:10px;padding:8px 12px;font-size:14px}
  /* hidden message popup */
  .secretBox{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#0a0a0a;border:1px solid rgba(255,215,100,0.08);padding:20px;border-radius:10px;display:none;z-index:999;color:var(--soft-white)}
  .secretBox.show{display:block;animation:pop .35s ease-out}
  @keyframes pop{from{transform:translate(-50%,-48%) scale(.95);opacity:0}to{transform:translate(-50%,-50%) scale(1);opacity:1}}
  /* blinking small eyes (applied via JS toggles) */
  .blink {opacity:.6}
</style>
</head>
<body>
<div class="cinemaOverlay" id="cinema"></div>

<div class="stage">
  <div class="card glow" id="card">
    <h1>XMAS Mystery Box</h1>
    <div class="controls">
      <button id="openBtn">Open Mystery Box</button>
      <button id="againBtn" class="small" style="display:none">Get Another Surprise</button>
      <button id="shareBtn" class="small" style="display:none">Copy Share Link</button>
    </div>

    <div id="ascii-box" aria-live="polite"></div>
    <div id="typing" aria-live="polite"></div>
    <div class="sig">â€” Crafted especially for you, by LF</div>
  </div>
</div>

<div class="secretBox" id="secretBox"></div>

<script>
/* ========== DATA: ASCII ART (10) & MESSAGES (20) ========== */
const asciiArts = [
`      .-""""-.
     /  .--.  \\
    /  /    \\  \\
   |  |  o o |  |
   |  |  \\_/ |  |
    \\  \\____/  /
     '._/  \\_.'
    Baby Santa`, 

`       _==/          i     i
     /  /  \\  .-"""-.  /\\_/\\
    /  /    \\/  o o  \\/ o o
   /  /       \\  ^  /\\  ^ 
  (  (         '---'  '---' )
   \\  \\  jingle bells!  /
    '._'-----------'_'`,

`      .-.
     (o o)
     | O|
     |  |
    /|  |\\
   (_|__|_)
    Frosty`,

`      /\\
     /  \\   _.-"""-._
    / /\\ \\.'  _   _  '.
   / /__\\ \\  (o) (o)   \\
  /  ____  \\   ^  ^    |
 /__/    \\__\\  \\___/  /
     RUDOLPH`,

`      *
     /A\\
    /AAA\\
   /AAAAA\\
  /AAAAAAA\\
      [#]
      [#]
    Money Tree`,

`     (\\_/)
     (â€¢_â€¢)
    <) )\\>   little elf
     / \\`,

`      /\\_/\\
     ( o.o )
     > ^ <   kitty with cap`,

`    .----.
   / .--. \\
  / /    \\ \\
  | |    | |
  \\ \\    / /
   '.__.'`,

`    _\/_
   /o o\\
  (  ^  )
   \\_=_/  gift box`,

`   (\\_/)
   (â€¢_â€¢)  <3
   / >ðŸŽ medium penguin`
];

const messages = [
 "Tonight, a quiet force chose youâ€¦ not by chance, but by alignment.",
 "Some souls attract miracles without trying. Yours is one of them.",
 "If you felt something in your chest just nowâ€¦ yes, that was the sign.",
 "There are nights that whisper. This one spelled your name.",
 "Youâ€™ve been walking with invisible luck for months. It shows.",
 "A hidden door just opened for you. Most people never see theirs.",
 "Your future self is smiling right now. They know what's coming.",
 "Someone out there believes in you more than you think. Theyâ€™re right.",
 "Not everyone finds messages like this. They appear when destiny shifts.",
 "If youâ€™re reading thisâ€¦ your next good thing is already on the way.",
 "The world is heavier than it looks â€” your light still cuts through.",
 "An unexpected hello will bring a new path. Be ready to answer.",
 "You are closer than you think to a story you'll tell for years.",
 "Small actions this week will compound into something large. Keep going.",
 "Your ideas are rarer than you believe. Share one of them.",
 "A silent supporter will make themselves known â€” accept the help.",
 "Luck likes people who keep showing up. You showed up. Luck noticed.",
 "This night contains a message written only for you. Read it twice.",
 "Hold your attention on what grows, not on what distracts you.",
 "A simple 'yes' will open a door â€” don't overthink it."
];

/* secret messages pool for mode '***' */
const secretMessages = [
  "Secret: A quiet opportunity will ask for a small yes. Say yes.",
  "Secret: Someone's memory of you is kinder than you expect.",
  "Secret: A private win arrives within the next 14 days."
];

let secretUsed = false;

/* ========== UI ELEMENTS ========== */
const openBtn = document.getElementById('openBtn');
const againBtn = document.getElementById('againBtn');
const shareBtn = document.getElementById('shareBtn');
const asciiBox = document.getElementById('ascii-box');
const typing = document.getElementById('typing');
const cinema = document.getElementById('cinema');
const secretBox = document.getElementById('secretBox');

/* ========== UTILS ========== */
function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

/* typewriter with promise */
function typeWriter(text, el, speed=30){
  return new Promise(res=>{
    el.textContent='';
    el.style.display='block';
    el.classList.add('gold-highlight');
    let i=0;
    const iv=setInterval(()=>{
      el.textContent += text.charAt(i);
      i++;
      if(i>=text.length){ clearInterval(iv); setTimeout(()=>el.classList.remove('gold-highlight'),300); res(); }
    }, speed);
  });
}

/* cinematic flash */
function doCinemaFlash(){
  cinema.classList.add('cinemaOn');
  setTimeout(()=>cinema.classList.remove('cinemaOn'),700);
}

/* lightweight chime using WebAudio API */
function chime(){
  try{
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type='sine';
    o.frequency.setValueAtTime(880, ctx.currentTime);
    o.frequency.exponentialRampToValueAtTime(1200, ctx.currentTime+0.12);
    g.gain.setValueAtTime(0.0001, ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.08, ctx.currentTime+0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.95);
    o.connect(g); g.connect(ctx.destination);
    o.start(); o.stop(ctx.currentTime+1.0);
  }catch(e){}
}

/* improved snow generator with drift */
function createSnow(count=36){
  for(let i=0;i<count;i++){
    const f = document.createElement('div');
    f.classList.add('snowflake');
    const size = 8 + Math.floor(Math.random()*18);
    f.style.fontSize = size + 'px';
    f.style.left = Math.random()*100 + 'vw';
    const dur = 3 + Math.random()*6;
    const delay = Math.random()*1.2;
    const drift = (Math.random()*40)-20;
    f.style.animation = `fall ${dur}s linear ${delay}s forwards`;
    f.style.transform = `translateX(0)`;
    f.innerText = Math.random()>.85 ? 'â†' : (Math.random()>.6 ? 'âœ¶' : '*');
    document.body.appendChild(f);
    // horizontal drift using transition
    setTimeout(()=>{ f.style.transition = `transform ${dur}s linear`; f.style.transform = `translateX(${drift}px) translateY(120vh)`; }, 50+delay*1000);
    // cleanup
    setTimeout(()=>f.remove(), (dur+delay)*1000 + 200);
  }
}

/* blink - toggles some arts for life */
function maybeBlink(currentArtEl){
  // if contains 'o o' try blink
  if(currentArtEl && /o o|â€¢_â€¢|o_o/.test(currentArtEl.textContent)){
    let original = currentArtEl.textContent;
    let blinked = original.replace(/o o|o_o|â€¢_â€¢/g, '- -');
    let iv = setInterval(()=>{
      currentArtEl.textContent = (currentArtEl.textContent===original) ? blinked : original;
    }, 900);
    // stop after few cycles
    setTimeout(()=>clearInterval(iv), 3700);
  }
}

/* copy link */
function copyLink(){
  const link = location.href;
  navigator.clipboard?.writeText(link).then(()=> alert('Link copied to clipboard!'));
}

/* secret trigger by typing '***' anywhere */
let keyBuffer = '';
window.addEventListener('keydown', (e)=>{
  keyBuffer += e.key;
  if(keyBuffer.length>5) keyBuffer = keyBuffer.slice(-5);
  if(!secretUsed && keyBuffer.endsWith('***')){
    secretUsed = true;
    showSecret(rand(secretMessages));
  }
});

/* show secret box */
function showSecret(msg){
  secretBox.textContent = msg;
  secretBox.classList.add('show');
  setTimeout(()=>secretBox.classList.remove('show'), 5000);
}

/* render one surprise: ascii + message + effects */
async function showSurprise(){
  openBtn.style.display='none';
  againBtn.style.display='none';
  shareBtn.style.display='none';
  doCinemaFlash();
  chime();

  // pick ascii + message
  const art = rand(asciiArts);
  const msg = rand(messages);

  // display ascii
  asciiBox.style.display='block';
  asciiBox.style.opacity = 0;
  asciiBox.textContent = art;
  // golden border glow
  asciiBox.classList.add('glow');
  setTimeout(()=>{ asciiBox.style.transform='translateY(0)'; asciiBox.style.opacity=1; asciiBox.style.boxShadow='0 20px 60px rgba(0,0,0,0.6), inset 0 0 40px rgba(255,210,120,0.04)'; }, 50);

  // slight delay, then type message
  await new Promise(r=>setTimeout(r,450));
  typing.style.display='block';
  typing.style.opacity=0;
  await typeWriter(msg, typing, 30);
  typing.style.opacity = 1;

  // maybe blink animation for ascii
  maybeBlink(asciiBox);

  // show improved snow
  createSnow(28);

  // reveal other controls
  setTimeout(()=>{ againBtn.style.display='inline-block'; shareBtn.style.display='inline-block'; }, 900);
}

/* reset for another surprise */
function resetForAnother(){
  asciiBox.style.opacity=0;
  typing.style.opacity=0;
  typing.textContent='';
  asciiBox.textContent='';
  setTimeout(()=>{ asciiBox.style.display='none'; typing.style.display='none'; openBtn.style.display='inline-block'; }, 450);
}

/* BUTTONS */
openBtn.addEventListener('click', async ()=>{
  await showSurprise();
});
againBtn.addEventListener('click', async ()=>{
  // small bounce effect
  againBtn.classList.add('shake');
  setTimeout(()=>againBtn.classList.remove('shake'), 400);
  // quickly fade out and show new
  asciiBox.style.opacity=0; typing.style.opacity=0;
  setTimeout(()=>{ asciiBox.textContent=''; typing.textContent=''; showSurprise(); }, 380);
});
shareBtn.addEventListener('click', copyLink);

/* initial float snow to make page alive */
setInterval(()=>createSnow(6), 1200);

/* optional: autoplay a single soft chime on first interaction hint (unobtrusive) */
let interacted=false;
document.addEventListener('pointerdown', function once(){
  if(!interacted){ interacted=true; chime(); document.removeEventListener('pointerdown', once); }
});

/* show tip bubble once (non-intrusive) */
setTimeout(()=>{ if(!secretUsed) { /* no UI */ } }, 3500);

</script>
</body>
</html>
